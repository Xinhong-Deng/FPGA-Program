		.text
		.global VGA_clear_charbuff_ASM, VGA_clear_pixelbuff_ASM, VGA_write_char_ASM, VGA_write_byte_ASM, VGA_draw_point_ASM
		.equ VGA_CHAR_BASE, 0xC9000000
		.equ VGA_PIXEL_BASE, 0xC8000000
		.equ VGA_CHARMAX_BASE, 0xC9001DD1
		.equ VGA_PIXELMAX_BASE, 0xC803BE80

VGA_clear_charbuff_ASM:
LDR R0, =0xC9000000
LDR R2, =VGA_CHARMAX_BASE
LOOPX:
CMP R0, R2
BXEQ LR
MOV R1,#0
STRB R1, [R0] 
ADD R0, R0, #1
BNE LOOPX
BX LR

VGA_clear_pixelbuff_ASM:
LDR R0, =0xC8000000
LDR R2, =VGA_PIXELMAX_BASE
LOOPY:
CMP R0, R2
BXEQ LR
MOV R1,#0
STRH R1, [R0] 
ADD R0, R0, #2
BNE LOOPY
BX LR

VGA_write_char_ASM:
PUSH {R0-R5}
LDR R3, =VGA_CHAR_BASE
CMP R0, #0
BXLT LR
CMP R0, #79
BXGT LR
CMP R1, #0
BXLT LR
CMP R1, #59
BXGT LR
MOV R4, R0
ADD R3, R3, R4
MOV R4, R1
MOV R5, #128
MUL R4, R4, R5
ADD R3, R3, R4
STRB R2, [R3]
POP {R0-R5}
BX LR

VGA_write_byte_ASM:
PUSH {R0-R5}
LDR R3, =VGA_CHAR_BASE
CMP R0, #0
BXLT LR
CMP R0, #79
BXGT LR
CMP R1, #0
BXLT LR
CMP R1, #59
BXGT LR
MOV R4, R0
ADD R3, R3, R4
MOV R4, R1
MOV R5, #128
MUL R4, R4, R5
ADD R3, R3, R4
//DEAL WITH R2 
AND R4, R2, #0xF0
LSR R4, #4
CMP R4, #9
ADDLE R4, R4, #48
ADDGT R4, R4, #65
STRB R4, [R3]
AND R4, R2, #0x0F
CMP R4, #9
ADDLE R4, R4, #48
ADDGT R4, R4, #55
ADD R3, R3, #1
STRB R4, [R3]
POP {R0-R5}
BX LR

VGA_draw_point_ASM:
PUSH {R0-R5}
LDR R3, = VGA_PIXEL_BASE
CMP R0, #0
BXLT LR
CMP R0, #320
BXEQ LR
CMP R1, #0
BXLT LR
CMP R1, #239
BXGT LR
MOV R4, R0
MOV R5, #2
MUL R4, R4, R5
ADD R3, R3, R4
MOV R4, R1
MOV R5, #1024
MUL R4, R4, R5
ADD R3, R3, R4
STRH R2, [R3]
POP {R0-R5}
BX LR


.end
